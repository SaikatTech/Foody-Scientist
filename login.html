<!DOCTYPE html>
<html>
<head>
  <title>Login</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<h2>Login with Phone</h2>

<input id="phone" placeholder="+91XXXXXXXXXX">
<button id="send">Send OTP</button>

<br><br>

<input id="otp" placeholder="Enter OTP">
<button id="verify">Verify</button>

<!-- ðŸ”´ REQUIRED: must exist BEFORE OTP -->
<div id="recaptcha-container"></div>

<script type="module">
import { sendOTP } from "./js/auth.js";
import { saveLoginTime } from "./js/session.js";

let confirmationResult = null;

document.getElementById("send").onclick = async () => {
  const phone = document.getElementById("phone").value;
  try {
    confirmationResult = await sendOTP(phone);
    alert("OTP sent");
  } catch (e) {
    alert(e.message);
    console.error(e);
  }
};

document.getElementById("verify").onclick = async () => {
  try {
    const otp = document.getElementById("otp").value;
    await confirmationResult.confirm(otp);
    saveLoginTime();
    window.location.href = "/Foody-Scientist/index.html";
  } catch (e) {
    alert("Invalid OTP");
    console.error(e);
  }
};
</script>

</body>
</html>
